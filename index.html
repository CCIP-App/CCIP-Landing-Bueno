<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>COSCUP Pass</title>
    <meta httpEquiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-itunes-app" content="app-id=1128067951, app-argument=" />
    <meta name="google-play-app" content="app-id=org.coscup.ccip" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="manifest" href="" />
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/main.css" />

</head>

<body style="overflow:hidden;">
    <div id="block">
        <img id="icon" src="img/logo.png" />
        <div id="background"></div>
        <h1>COSCUP PASS</h1>
        <p>下載應用程式後，即可登入使用。</p>
        <div id="store">
            <a href="#" id="goosrc"></a><a href="#" id="appsrc"></a>
            <a href="#" id="iosLogin">安裝完 App 後，請此登入！</a>
        </div>
    </div>
    <div id="background-house-container">
        <div class="subpage--banner">
            <div id="hero">
                <div class="layer-bg layer"></div>
                <div class="layer-1 layer"></div>
                <div class="layer-2 layer"></div>
                <div class="layer-3 layer"></div>
            </div>
        </div>
    </div>
    <script>
        function parameters() {
            return location.search.split('?').pop().split('&').map(p => {
                var ps = p.split('=');
                var o = {};
                o[ps.shift()] = ps.join('=');
                return o;
            }).reduce((a, b) => {
                var o = a;
                for (var k in b) {
                    o[k] = b[k];
                }
                return o;
            });
        }
        window.onload = function () {
            var appsrc = document.getElementById('appsrc');
            var goosrc = document.getElementById('goosrc');
            var iosLogin = document.getElementById('iosLogin');
            appsrc.setAttribute('href', 'https://itunes.apple.com/app/id' + document.querySelector('meta[name="apple-itunes-app"]').content.split(',').shift().trim().split('=').pop().trim());
            goosrc.setAttribute('href', 'https://play.google.com/store/apps/details?id=' + document.querySelector('meta[name="google-play-app"]').content.split('=').pop());
            var mobile = {
                iOS: navigator.userAgent.match(/iPhone|iPad|iPod/i) ? true : false,
                Android: navigator.userAgent.match(/Android/i) ? true : false
            };
            if (mobile.iOS) {
                goosrc.style.display = 'none';
                appsrc.classList.add('one');
                if ((parameters().token || '').length != 0) {
                    iosLogin.setAttribute('href', 'ccip://login/?token=' + parameters().token);
                    iosLogin.style.display = 'block';
                }
            } else if (mobile.Android) {
                appsrc.style.display = 'none';
                goosrc.classList.add('one');
            }
        }
    </script>
</body>

</html>